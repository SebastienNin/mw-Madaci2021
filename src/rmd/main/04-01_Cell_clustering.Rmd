---
output: html_document
editor_options: 
  chunk_output_type: console
---

## Cell clustering

For each sample, we performed a clustering based on variable genes

```{r}
perform_clustering_seurat <- function(seurat_obj){
  seurat_obj <- FindVariableFeatures(seurat_obj, selection.method = "vst", nfeatures = 2000)
  seurat_obj <- ScaleData(seurat_obj, do.scale = F)
  seurat_obj <- RunPCA(seurat_obj, features = VariableFeatures(object = seurat_obj))
  seurat_obj <- FindNeighbors(seurat_obj, dims = 1:15)
  seurat_obj <- FindClusters(seurat_obj, resolution = 0.8)
  seurat_obj <- RunUMAP(seurat_obj, dims = 1:15)
}
```

```{r}
Seurat_object_list <- list(Seurat_UPN23_filtered, Seurat_UPN29_filtered, 
                           Seurat_UPN23_UPN29_cellhashing_UPN23_filtered, Seurat_UPN23_UPN29_cellhashing_UPN29_filtered,
                           Seurat_UPN73_filtered, Seurat_UPN78_filtered,
                           Seurat_UPN73_UPN78_cellhashing_UPN73_filtered, Seurat_UPN73_UPN78_cellhashing_UPN78_filtered)
Seurat_object_list_clustered <- lapply(Seurat_object_list, perform_clustering_seurat)
```